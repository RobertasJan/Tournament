@page "/register"
@using Tournament.Shared.User

<PageTitle>Register</PageTitle>
<MudGrid>
    <MudItem xs="0" sm="3"></MudItem>
    <MudItem xs="12" sm="6">
        <MudPaper Class="pa-2" Elevation="3">
            <MudText Typo="Typo.subtitle2">Login</MudText>
            <MudGrid>
                <MudItem xs="12">
                    <MudTextField @bind-Value="Name" Label="Enter email" Variant="Variant.Text" Required="true" RequiredError="Email is required!"></MudTextField>
                </MudItem>
                <MudItem xs="12">
                    <MudTextField @bind-Value="Password" Label="Enter password" Variant="Variant.Text" Required="true" RequiredError="Password is required!"></MudTextField>
                </MudItem>
                <MudItem xs="12">
                    <MudTextField @bind-Value="RepeatPassword" Label="Repeat password" Variant="Variant.Text" Required="true" RequiredError="Repeated password is required!"></MudTextField>
                </MudItem>
            </MudGrid>
            <MudButton Class="mt-4" Variant="Variant.Filled" Color="Color.Primary" FullWidth="true" OnClick="@(async () => await Submit())">Register</MudButton>
        </MudPaper>
    </MudItem>
    <MudItem xs="0" sm="3"></MudItem>
</MudGrid>
<AuthorizeView>
    @context.User.Identity?.Name
</AuthorizeView>
@code {
    [Inject] UserService UserService { get; set; }

    string Name { get; set; }
    string Password { get; set; }
    string RepeatPassword { get; set; }

    private async Task Submit()
    {
        await UserService.Register(new UserModel()
            {
                Login = Name,
                Password = Password
            });
        NavigationManager.NavigateTo($"/", false);
    }
}